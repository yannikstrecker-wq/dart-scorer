<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#1e7f4f">
<title>Dart Scorer 501</title>

<style>
:root{
  --green:#1e7f4f;
  --red:#b8322a;
  --gold:#d4af37;
  --bg:#050806;
  --text:#f5f5f5;
  --muted:#9aa4a1;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:radial-gradient(circle at top,#1b5e3a 0%,#050806 70%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:var(--text);
  padding:10px;
}
.app{max-width:900px;margin:auto}

/* HEADER */
.header{text-align:center;margin-bottom:6px}

/* PLAYERS */
.players{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.player{
  background:#111;
  border:2px solid #0f5d35;
  border-radius:14px;
  padding:12px;
  text-align:center;
}
.player.active{
  border-color:var(--gold);
  box-shadow:0 0 12px rgba(212,175,55,.6);
}
.player input{
  width:100%;
  background:#000;
  border:1px solid #0f5d35;
  border-radius:8px;
  color:var(--text);
  text-align:center;
  font-weight:800;
  padding:6px;
}
.score{font-size:40px;font-weight:900}
.avg,.legs{font-size:13px;color:var(--muted)}

/* CHECKOUT HINT */
.checkout{
  margin:8px 0;
  padding:8px;
  text-align:center;
  border-radius:8px;
  background:#000;
  border:2px solid #0f5d35;
  font-weight:800;
}
.checkout.ok{border-color:var(--green);color:#9cffc8}
.checkout.no{border-color:#333;color:#777}

/* MODES */
.modes{display:flex;gap:8px;margin:10px 0}
.mode{
  flex:1;
  padding:12px;
  border-radius:10px;
  text-align:center;
  font-weight:900;
  cursor:pointer;
  background:#000;
  border:2px solid #0f5d35;
}
.mode.active{
  background:var(--green);
  color:#000;
  border-color:var(--gold);
}

/* THROWS */
.throws{display:flex;gap:8px;margin-bottom:8px}
.throw{
  flex:1;
  padding:10px;
  background:#000;
  border-radius:8px;
  border:2px solid #0f5d35;
  text-align:center;
  font-weight:800;
}

/* BOARD */
.board-wrap{display:flex;justify-content:center;margin:10px 0}
svg{width:320px;height:320px;pointer-events:none}
.hit-area{fill:transparent;pointer-events:auto}
.bull25{fill:var(--green);pointer-events:auto}
.bull50{fill:var(--red);pointer-events:auto}

/* ACTIONS */
.actions{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:8px;
}
.btn{
  padding:14px;
  border-radius:12px;
  font-weight:900;
  cursor:pointer;
  background:#000;
  border:2px solid #0f5d35;
  text-align:center;
}
.btn.green{background:var(--green);color:#000;border-color:var(--gold)}
.btn.red{background:var(--red);border-color:#fff}

/* OVERLAY */
.overlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.overlay.show{display:flex}
.overlay-box{
  background:#000;
  border:3px solid var(--gold);
  padding:30px;
  border-radius:16px;
  text-align:center;
}
.overlay-box h2{margin:0;color:var(--gold)}

.footer{
  margin-top:10px;
  text-align:center;
  font-size:12px;
  color:var(--muted);
}
.footer span{color:var(--gold);font-weight:700}
</style>
</head>

<body>
<div class="app">

<div class="header"><h2>üéØ Dart Scorer 501</h2></div>

<div class="players">
  <div class="player active" id="p0">
    <input value="Spieler 1">
    <div class="score" id="score0">501</div>
    <div class="avg">AVG: <span id="avg0">0.0</span></div>
    <div class="legs">Legs: <span id="legs0">0</span></div>
  </div>
  <div class="player" id="p1">
    <input value="Spieler 2">
    <div class="score" id="score1">501</div>
    <div class="avg">AVG: <span id="avg1">0.0</span></div>
    <div class="legs">Legs: <span id="legs1">0</span></div>
  </div>
</div>

<div class="checkout" id="checkout">Checkout: ‚Äì</div>

<div class="modes">
  <div class="mode active" data-m="1">SINGLE</div>
  <div class="mode" data-m="2">DOUBLE</div>
  <div class="mode" data-m="3">TRIPLE</div>
</div>

<div class="throws" id="throws"></div>

<div class="board-wrap">
<svg viewBox="0 0 200 200">
  <circle cx="100" cy="100" r="95" fill="#000" stroke="#0f5d35" stroke-width="6"/>
  <circle cx="100" cy="100" r="22" class="bull25" onclick="hitBull(25)"/>
  <circle cx="100" cy="100" r="12" class="bull50" onclick="hitBull(50)"/>
  <g id="nums"></g>
</svg>
</div>

<div class="actions">
  <div class="btn" onclick="undo()">‚Ü©Ô∏è Undo</div>
  <div class="btn green" onclick="endRound()">Runde</div>
  <div class="btn red" onclick="bust()">Bust</div>
</div>

<div class="footer">
  Programmiert von <span>Yannik Strecker</span>
</div>

</div>

<div class="overlay" id="overlay">
  <div class="overlay-box">
    <h2 id="overlayText"></h2>
    <br>
    <div class="btn green" onclick="newMatch()">Neues Match</div>
  </div>
</div>

<script>
const numbers=[20,1,18,4,13,6,10,15,2,17,3,19,7,16,8,11,14,9,12,5];
const nums=document.getElementById("nums");
const cx=100,cy=100,r=70;

numbers.forEach((n,i)=>{
  const a=(i/numbers.length)*2*Math.PI-Math.PI/2;
  const x=cx+r*Math.cos(a);
  const y=cy+r*Math.sin(a);
  const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
  c.setAttribute("cx",x);c.setAttribute("cy",y);
  c.setAttribute("r",18);c.setAttribute("class","hit-area");
  c.onclick=()=>hit(n);
  nums.appendChild(c);
});

let scores=[501,501],legs=[0,0],cur=0,mode=1;
let throws=[],turnStart=501;
let darts=[0,0],points=[0,0];
let gameOver=false;

document.querySelectorAll(".mode").forEach(m=>{
  m.onclick=()=>{
    document.querySelectorAll(".mode").forEach(x=>x.classList.remove("active"));
    m.classList.add("active");
    mode=parseInt(m.dataset.m);
  };
});

function hit(n){
  if(gameOver||throws.length>=3)return;
  const v=n*mode;
  throws.push({v});
  darts[cur]++; points[cur]+=v;
  render(); updateAvg(); updateCheckout();
}
function hitBull(v){
  if(gameOver||throws.length>=3)return;
  throws.push({v});
  darts[cur]++; points[cur]+=v;
  render(); updateAvg(); updateCheckout();
}
function undo(){
  if(!throws.length||gameOver)return;
  const last=throws.pop();
  darts[cur]--; points[cur]-=last.v;
  render(); updateAvg(); updateCheckout();
}
function render(){
  throwsEl.innerHTML="";
  throws.forEach(t=>{
    const d=document.createElement("div");
    d.className="throw";
    d.textContent=t.v;
    throwsEl.appendChild(d);
  });
}
function endRound(){
  if(gameOver)return;
  const sum=throws.reduce((a,b)=>a+b.v,0);
  const rest=scores[cur]-sum;

  if(rest===0 && throws.at(-1).v%2===0){
    scores[cur]=0;
    legs[cur]++;
    if(legs[cur]===2){
      endMatch();
      return;
    }
  }else if(rest<0||rest===1){
    scores[cur]=turnStart;
  }else{
    scores[cur]=rest;
  }
  next();
}
function bust(){scores[cur]=turnStart;next()}
function next(){
  throws=[];render();
  cur=1-cur;
  turnStart=scores[cur];
  update();updateCheckout();
}
function endMatch(){
  gameOver=true;
  document.getElementById("overlayText").textContent=
    `${document.querySelectorAll("input")[cur].value} gewinnt das Match!`;
  overlay.classList.add("show");
}
function newMatch(){
  scores=[501,501];legs=[0,0];darts=[0,0];points=[0,0];
  cur=0;turnStart=501;gameOver=false;
  overlay.classList.remove("show");
  update();updateAvg();updateCheckout();render();
}
function update(){
  score0.textContent=scores[0];
  score1.textContent=scores[1];
  legs0.textContent=legs[0];
  legs1.textContent=legs[1];
  p0.classList.toggle("active",cur===0);
  p1.classList.toggle("active",cur===1);
}
function updateAvg(){
  avg0.textContent=(points[0]/Math.max(1,darts[0])*3).toFixed(1);
  avg1.textContent=(points[1]/Math.max(1,darts[1])*3).toFixed(1);
}
function updateCheckout(){
  const c=document.getElementById("checkout");
  const s=scores[cur];
  if(s<=170){
    c.textContent=`Checkout m√∂glich bei ${s}`;
    c.className="checkout ok";
  }else{
    c.textContent="Checkout: ‚Äì";
    c.className="checkout no";
  }
}
update();updateCheckout();
</script>
</body>
</html>
