<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>Dart Turnier</title>

<style>
:root{
  --green:#1e7f4f;
  --red:#b8322a;
  --gold:#d4af37;
  --bg:#050806;
  --text:#f5f5f5;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:radial-gradient(circle at top,#1b5e3a 0%,#050806 70%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:var(--text);
  padding:10px;
}
.app{max-width:1200px;margin:auto}

/* HEADER */
.header{
  text-align:center;
  padding:12px;
  border:2px solid var(--gold);
  border-radius:14px;
  background:#000;
  margin-bottom:12px;
}

/* PANELS */
.panel{
  background:#111;
  padding:12px;
  border-radius:14px;
  margin-bottom:12px;
}

/* MATCH */
.scores{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.playerBox{
  background:#000;
  border:2px solid #0f5d35;
  border-radius:12px;
  padding:10px;
}
.playerBox.active{border-color:var(--gold)}
.score{font-size:42px;font-weight:900}

/* INFO */
.throws{
  text-align:center;
  margin-top:6px;
  font-weight:800;
  color:#9cffc8;
}
.checkout{
  text-align:center;
  margin-top:4px;
  font-weight:700;
  color:#ffd700;
}

/* INPUT */
.modes{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
.mode{
  padding:10px;font-weight:900;border-radius:10px;
  border:2px solid #0f5d35;background:#000
}
.mode.active.single{background:#333}
.mode.active.double{background:var(--green);color:#000}
.mode.active.triple{background:var(--red)}

.numbers{
  display:grid;grid-template-columns:repeat(5,1fr);gap:6px
}
.num{
  padding:14px;font-size:18px;font-weight:900;
  background:#000;color:#eaeaea;
  border:2px solid #0f5d35;border-radius:10px
}
.bull{color:#ffd700}

/* ACTIONS */
.actions{
  display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px
}
.btn{
  padding:14px;font-size:16px;font-weight:900;
  border-radius:12px;border:none
}
.green{background:var(--green);color:#000}
.red{background:var(--red);color:#fff}
</style>
</head>

<body>
<div class="app">

<div class="panel">
  <h2 id="matchTitle"></h2>
  <div class="scores">
    <div class="playerBox active" id="box0">
      <div id="name0"></div>
      <div class="score" id="score0">501</div>
      Legs: <span id="legs0">0</span>
    </div>
    <div class="playerBox" id="box1">
      <div id="name1"></div>
      <div class="score" id="score1">501</div>
      Legs: <span id="legs1">0</span>
    </div>
  </div>

  <div class="throws" id="throws">Aufnahme: –</div>
  <div class="checkout" id="checkout">Checkout: –</div>
</div>

<div class="panel">
  <div class="modes">
    <button class="mode single active" onclick="setMode(1)">SINGLE</button>
    <button class="mode double" onclick="setMode(2)">DOUBLE</button>
    <button class="mode triple" onclick="setMode(3)">TRIPLE</button>
  </div>

  <div class="numbers" id="numbers"></div>

  <div class="actions">
    <button class="btn red" onclick="undo()">Undo</button>
    <button class="btn green" onclick="nextTurn()">Weiter</button>
  </div>
</div>

</div>

<script>
/* ===== STATE ===== */
let players=["Spieler A","Spieler B"];
let scores=[501,501],legs=[0,0],current=0,throws=0;
let dartHistory=[],mode=1;

/* ===== INIT ===== */
name0.textContent=players[0];
name1.textContent=players[1];

const nums=document.getElementById("numbers");
for(let i=1;i<=20;i++)addNum(i);
addNum(25,"Bull","bull");
addNum(50,"DBull","bull");
addNum(0,"0");

function addNum(v,l,c){
  const b=document.createElement("button");
  b.className="num "+(c||"");
  b.textContent=l||v;
  b.onclick=()=>throwDart(v);
  nums.appendChild(b);
}

/* ===== GAME ===== */
function throwDart(v){
  if(throws>=3)return;

  let val=v<=20?v*mode:v;
  scores[current]-=val;

  const label=(mode===2?"D":mode===3?"T":"")+v;
  dartHistory.push({val,label});
  throws++;

  setMode(1);
  updateUI();
}

function undo(){
  if(!dartHistory.length)return;
  const last=dartHistory.pop();
  scores[current]+=last.val;
  throws--;
  updateUI();
}

function nextTurn(){
  if(scores[current]===0 && dartHistory.at(-1).val%2===0){
    legs[current]++;
    scores=[501,501];
  }else if(scores[current]<0 || scores[current]===1){
    scores[current]=501;
  }
  current=1-current;
  throws=0;
  dartHistory=[];
  updateUI();
}

/* ===== UI ===== */
function updateUI(){
  score0.textContent=scores[0];
  score1.textContent=scores[1];
  legs0.textContent=legs[0];
  legs1.textContent=legs[1];
  box0.classList.toggle("active",current===0);
  box1.classList.toggle("active",current===1);

  throws.textContent=dartHistory.length
    ? "Aufnahme: "+dartHistory.map(d=>d.label).join(" | ")
    : "Aufnahme: –";

  updateCheckout();
}

function updateCheckout(){
  const c=document.getElementById("checkout");
  const s=scores[current];
  const map={
    170:"T20 T20 Bull",
    167:"T20 T19 Bull",
    100:"T20 D20",
    80:"T20 D10",
    60:"S20 D20",
    50:"Bull",
    40:"D20",
    32:"D16",
    24:"D12",
    16:"D8",
    8:"D4",
    4:"D2",
    2:"D1"
  };
  c.textContent=s<=170 ? "Checkout: "+(map[s]||s) : "Checkout: –";
}

function setMode(m){
  mode=m;
  document.querySelectorAll(".mode").forEach(b=>b.classList.remove("active"));
  document.querySelector(`.mode.${m===1?"single":m===2?"double":"triple"}`).classList.add("active");
}

updateUI();
</script>
</body>
</html>
