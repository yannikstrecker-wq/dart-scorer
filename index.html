<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>Dart Turnier 6 Spieler</title>

<style>
:root{
  --bg:#050806;
  --green:#1e7f4f;
  --red:#b8322a;
  --gold:#d4af37;
  --text:#f5f5f5;
  --muted:#9aa4a1;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:radial-gradient(circle at top,#1b5e3a 0%,#050806 70%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:var(--text);
  padding:10px;
}
.app{max-width:900px;margin:auto}

/* HEADER */
.header{
  text-align:center;
  padding:12px;
  border:2px solid var(--gold);
  border-radius:14px;
  background:#000;
  margin-bottom:12px;
}
.header h1{margin:0;color:var(--gold)}
.header p{margin:4px 0 0;font-size:13px;color:var(--muted)}

/* SETUP */
.setup,.panel{
  background:#111;
  padding:12px;
  border-radius:14px;
  margin-bottom:12px;
}
.setup input{
  width:100%;
  margin-bottom:6px;
  padding:10px;
  font-size:16px;
  font-weight:700;
  border-radius:8px;
  border:none;
  text-align:center;
}

/* TABLE */
table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
th,td{
  border-bottom:1px solid #333;
  padding:6px;
  text-align:center;
}
th{color:var(--gold)}

/* MATCH */
.match{
  background:#111;
  padding:12px;
  border-radius:14px;
  margin-bottom:10px;
  text-align:center;
}
.scores{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.playerBox{
  background:#000;
  border:2px solid #0f5d35;
  border-radius:12px;
  padding:10px;
}
.playerBox.active{
  border-color:var(--gold);
}
.score{
  font-size:42px;
  font-weight:900;
}

/* INPUT */
.inputGrid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:6px;
}
.num{
  padding:14px;
  font-size:18px;
  font-weight:900;
  background:#000;
  border:2px solid #0f5d35;
  border-radius:10px;
  color:#fff;
}
.num:disabled{opacity:.3}

.double{background:var(--green);color:#000}
.triple{background:var(--red)}
.bull{background:#444}

.actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
  margin-top:8px;
}
.btn{
  padding:14px;
  font-size:16px;
  font-weight:900;
  border-radius:12px;
  border:none;
}
.green{background:var(--green);color:#000}
.red{background:var(--red);color:#fff}

/* OVERLAY */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  display:none;
  align-items:center;
  justify-content:center;
}
.overlay.show{display:flex}
.box{
  background:#000;
  padding:24px;
  border-radius:16px;
  border:3px solid var(--gold);
  text-align:center;
}
</style>
</head>

<body>
<div class="app">

<div class="header">
  <h1>ðŸŽ¯ Dart Turnier</h1>
  <p>6 Spieler Â· Gruppen â†’ KO Â· Best of 3 Â· Double Out</p>
</div>

<!-- SETUP -->
<div class="setup" id="setup">
  <h3>Gruppe A</h3>
  <input id="p0" placeholder="Spieler A1">
  <input id="p1" placeholder="Spieler A2">
  <input id="p2" placeholder="Spieler A3">
  <h3>Gruppe B</h3>
  <input id="p3" placeholder="Spieler B1">
  <input id="p4" placeholder="Spieler B2">
  <input id="p5" placeholder="Spieler B3">
  <button class="btn green" onclick="startTournament()">Turnier starten</button>
</div>

<!-- TABLES -->
<div class="panel" id="tables" style="display:none">
  <h3>Gruppentabellen</h3>
  <div id="groupTables"></div>
</div>

<!-- MATCH -->
<div class="match" id="match" style="display:none">
  <h2 id="matchTitle"></h2>
  <div class="scores">
    <div class="playerBox active" id="box0">
      <div id="name0"></div>
      <div class="score" id="score0">501</div>
      <div>Legs: <span id="legs0">0</span></div>
    </div>
    <div class="playerBox" id="box1">
      <div id="name1"></div>
      <div class="score" id="score1">501</div>
      <div>Legs: <span id="legs1">0</span></div>
    </div>
  </div>
</div>

<div class="panel inputGrid" id="numbers" style="display:none"></div>

<div class="actions" id="actions" style="display:none">
  <button class="btn red" onclick="undo()">Undo</button>
  <button class="btn green" onclick="nextTurn()">Weiter</button>
</div>

</div>

<div class="overlay" id="overlay">
  <div class="box">
    <h2 id="overlayText"></h2>
    <button class="btn green" onclick="continueTournament()">Weiter</button>
  </div>
</div>

<script>
/* ================= STATE ================= */
let groups=[],matches=[],stage="groups",matchIndex=0;
let scores=[501,501],legs=[0,0],current=0,throws=0;
let history=[];

/* ================= SETUP ================= */
function startTournament(){
  const names=[p0,p1,p2,p3,p4,p5].map((i,n)=>i.value||`Spieler ${n+1}`);
  groups=[
    {name:"Gruppe A",players:names.slice(0,3),points:[0,0,0]},
    {name:"Gruppe B",players:names.slice(3,6),points:[0,0,0]}
  ];
  matches=[];
  groups.forEach(g=>{
    matches.push({group:g,a:0,b:1});
    matches.push({group:g,a:0,b:2});
    matches.push({group:g,a:1,b:2});
  });
  setup.style.display="none";
  tables.style.display="block";
  match.style.display="block";
  numbers.style.display="grid";
  actions.style.display="grid";
  buildNumbers();
  renderTables();
  loadMatch();
}

/* ================= NUMBERS ================= */
function buildNumbers(){
  numbers.innerHTML="";
  for(let i=1;i<=20;i++){
    addNum(i,i);
  }
  addNum("0",0);
  addNum("D","D",true);
  addNum("T","T",false,true);
  addNum("Bull","BULL");
}
function addNum(label,value,isDouble=false,isTriple=false){
  const b=document.createElement("button");
  b.className="num";
  if(isDouble)b.classList.add("double");
  if(isTriple)b.classList.add("triple");
  if(value==="BULL")b.classList.add("bull");
  b.textContent=label;
  b.addEventListener("pointerdown",()=>throwDart(value));
  numbers.appendChild(b);
}

/* ================= GAME ================= */
function loadMatch(){
  scores=[501,501];legs=[0,0];current=0;throws=0;history=[];
  const m=matches[matchIndex];
  name0.textContent=m.group.players[m.a];
  name1.textContent=m.group.players[m.b];
  updateUI();
}
function throwDart(v){
  if(throws>=3)return;
  let val=0;
  if(v==="D"){history.push(0);return;}
  if(v==="T"){history.push(0);return;}
  if(v==="BULL"){val=50;}
  else val=parseInt(v);

  scores[current]-=val;
  history.push(val);
  throws++;
  updateUI();
}
function undo(){
  if(!history.length)return;
  const v=history.pop();
  scores[current]+=v;
  throws--;
  updateUI();
}
function nextTurn(){
  if(scores[current]===0){
    legs[current]++;
    if(legs[current]===2){
      endMatch();
      return;
    }
    scores=[501,501];
  }
  if(scores[current]<0||scores[current]===1){
    scores[current]=501;
  }
  throws=0;
  history=[];
  current=1-current;
  updateUI();
}
function endMatch(){
  const m=matches[matchIndex];
  const winner=current===0?m.a:m.b;
  m.group.points[winner]++;
  renderTables();
  overlayText.textContent=`${m.group.players[winner]} gewinnt das Match`;
  overlay.classList.add("show");
}
function continueTournament(){
  overlay.classList.remove("show");
  matchIndex++;
  if(matchIndex<matches.length){
    loadMatch();
  }else{
    overlayText.textContent="Gruppenphase beendet";
    overlay.classList.add("show");
  }
}

/* ================= UI ================= */
function updateUI(){
  score0.textContent=scores[0];
  score1.textContent=scores[1];
  legs0.textContent=legs[0];
  legs1.textContent=legs[1];
  box0.classList.toggle("active",current===0);
  box1.classList.toggle("active",current===1);
}
function renderTables(){
  groupTables.innerHTML="";
  groups.forEach(g=>{
    let html=`<h4>${g.name}</h4><table><tr><th>Spieler</th><th>Punkte</th></tr>`;
    g.players.forEach((p,i)=>{
      html+=`<tr><td>${p}</td><td>${g.points[i]}</td></tr>`;
    });
    html+="</table>";
    groupTables.innerHTML+=html;
  });
}
</script>
</body>
</html>
